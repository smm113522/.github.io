---
layout:     post
title:      "重构之路尝试"
subtitle:   " \"app \""
date:       2017-10-12 14:14:00
author:     "Smm"
header-img: "img/helloWorld.jpg"
tags:
    - app
---


## 构思
上个项目结束也快一个月了。希望在接下来的项目或者产品中能够有些新的东西，
以及新鲜的东西。

上个月吧货车app ，幼教app 。开发完成，幼教拿到尾款，货车正在修改新的需求和新的功能，
添加钱的问题，都让商务去做吧。

所以现在有时间做360外勤或外勤同类的产品。
需求是仿照，再结合自己公司目前的需求和现状，在去开发和新添加功能或重复做一些东西。

所以不能像做项目一样，堆集的代码在这里，而是更多优化和扩展在里面了，既然做了，就开始好好去准备。

## 开始招手去做吧。

首先，从总体框架中出发吧，做好组件化和路由。
因为在这里功能都是自己去想的，还没有看市场的反应，所以先做一些组件化，让底层lib 创建。 在分为好几个module,然后通过路由进行跳转和组件之间的通信。

几乎已经搭建好了。

几乎是一个功能一个module 。进行多个lib 的拆分，在通过底层lib 进行连接或拼接。

## 组件不同扩展

接着我会添加一下要扩展的东西。
1.百度地图lib
  里面有多处so jar包的替换和使用。 已经距离的测试，地图上的标点图的替换。 会有聚合，画点，换线，画区域等功能。
2，百度统计功能，之前使用了友盟统计，友盟在阿里巴巴旗下了，所有有很多淘宝的东西，看着不舒服，集成了友盟，很多错误和bug 不易看到。
所有百度统计自己觉得好点。

3，推送lib ，集合小米和华为百度推送进行集合。

4，支付功能 ，经理让使用聚合的ping++ ,他感觉代码简单好用，
但是会有一个就是包会大，因为里面会有多余的支付方式，百度钱包，腾讯支付等支付。总体还是比较好的，但是后台还得集成。
做两手准备吧。一个ping++ 一个自己收集封装一下吧。

5，im 部分 之前是环信的imsdk，费了老大力气，把头像和名字给替换掉，经理说在想想其他办法了，就不了而知了。
自己想找找其他的好的。自己写过，只有文字和图片的，还没有保留本地。太费劲了，这个是很薄弱的。

6，自定义view 和dialog部分。

7，版本更新部分。添加 apk 下载方式，还有腾讯AndFix 环境进行更新，为了防止自己失误造成文字和其他部分的错误。

8，okhttp 的使用，添加okhttp3-persistent-cookiejar 的使用，对高效的处理url很有帮助，对于验证验证码其他操作很有效。

9 自己定义log 文件。


10，权限申请 建立baseactivity 中一句话搞定权限问题。

12，SmartRefreshLayout 的使用，然后封装上拉和下啦刷新界面
然后在对没有网络没有数据等不同状态界面操作

13，高效的json 解析utils 使用

14，glide 进行第二次封装，为啥还封装，因为imageload的教训，替换起来很费劲。
	glide 多个方法的使用，统一使用一个方法，对圆角和错误和默认图片等不同操作的处理。

15，统一的Toasty 的使用。

进行上面的总体的进行重构，想多少记录多少吧。
对不合理的地方，会画很长时间，避免堆集和重复。

## 后记


这个是基本的框架和基本的使用情况，也行很多android 方法的没有涉及到
入aidi的使用，多个service的使用，热修复，插件化处理等。
没有一些技术难题，例如：是否经得起大数据和多用户的的情况下处理，毕竟所有的项目中用户都没有超过100用户量，
是否经得起百万用户的情况，以及对突发情况的处理和多项处理。


  